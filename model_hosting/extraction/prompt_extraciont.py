class PromptExtraction:
    def __init__(self):
        pass

    def make_prompt_to_query_mate(self, doc_text, input_text):
        prompt = f"""
            문서 평가를 수행하여 핵심 내용을 추출하고 잘 작성된 부분과 잘못된 부분을 식별한 후 점수를 매깁니다. 문서 점수는 100점 만점이며, 모든 문서는 100점에서 시작하며 잘못된 부분이 발견될 때마다 점수를 차감합니다.

            # Steps

            1. **핵심 내용 추출:** 문서의 주요 메시지나 주장을 식별합니다.
            2. **잘 작성된 부분 식별:** 논리적 구조, 어휘 사용, 문법적 정확성과 같은 점에서 문서의 장점을 파악합니다.
            3. **잘못된 부분 식별:** 논리적 불일치, 부정확한 정보, 불명확한 표현 등을 확인합니다.
            4. **점수 조정:** 잘못된 부분마다 점수를 깎고 그 이유를 명시합니다.
            5. **최종 평가:** 최종 점수와 함께 문서의 강점과 개선할 점을 요약합니다.

            # Output Format

            - 문서의 핵심 내용을 1-2 문장으로 요약합니다.
            - 잘 작성된 부분에 대한 평가와 그 이유를 나열합니다.
            - 잘못된 부분에 대한 평가와 그 이유를 나열합니다.
            - 잘못된 부분에 따라 몇 점이 차감되었는지 명시합니다.
            - 최종 문서 점수를 제공합니다.
            - 전체적인 평가서를 문단 형식으로 작성합니다.

            # Examples

            **Input:** {doc_text},{input_text}

            **Output:**

            ```
            - 핵심 내용 요약: [문서의 핵심 내용을 간단히 요약합니다.]
            - 잘 작성된 부분 평가:
            - [구체적인 부분]이 [이유]로 인해 잘 작성되었습니다.
            - ...
            - 잘못된 부분 평가:
            - [구체적인 부분]이 [문제점]으로 인해 잘못되었습니다.
            - ...
            - 차감된 점수: [잘못된 부분별로 차감된 점수 명시]
            - 최종 점수: [차감 후 최종 점수]
            - 종합 평가 요약: 문서에서 잘 된 부분과 개선할 부분에 대한 평가를 종합하여 진술합니다.
            ```

            # Notes

            - 문법적, 논리적, 내용적 오류를 감지할 때 주의하십시오.
            - 점수 차감 시 이유를 명확하고 구체적으로 설명합니다.
            - 전반적인 분석과 평가에 객관적이고 공정하게 접근합니다.
            """
        return prompt
    
    def test_make_prompt_to_extract_criteria(self):
        return """
        당신은 사업 제안서 문서를 분석하여, 심사자가 사업을 평가할 때 참고하는 '평가 기준(또는 평가 요소)'을 정확히 추출하는 전문가입니다.

# 역할
- 당신은 사업제안서의 구조, 항목, 제목, 부제목, 표 등의 정보를 근거로 평가 요소만을 식별해야 합니다.
- 사업의 목적, 기대 효과, 추진 계획, 예산 등 실제 심사자가 중요하게 평가할 만한 내용을 기준으로 판단해야 합니다.

# 출력 형식
- 반드시 항목 번호를 붙여 정리하세요.
- 항목당 하나의 평가 기준을 요약된 문장으로 표현하세요.
- 평가는 일반적으로 심사위원이 체크리스트 형태로 사용할 수 있게 작성되어야 합니다.

# 제약 조건
- 사업 설명 자체, 지원 자격, 신청 절차 등은 평가 기준이 아니므로 제외하세요.
- 문서에 나타나지 않은 추론은 하지 마세요.

예시:
1. 사업 목적의 구체성과 명확성
2. 사업 수행 인력의 전문성
3. 추진 일정의 현실성
4. 예산 편성의 타당성과 적정성
5. 기대 효과의 실현 가능성


# 출력 (평가 기준 항목 목록):
"""
    
    def make_prompt_to_extract_criteria(self, document_text):
        return f"""
당신은 사업 제안서 문서를 분석하여, 심사자가 사업을 평가할 때 참고하는 '평가 기준(또는 평가 요소)'을 정확히 추출하는 전문가입니다.

# 역할
- 당신은 사업제안서의 구조, 항목, 제목, 부제목, 표 등의 정보를 근거로 평가 요소만을 식별해야 합니다.
- 사업의 목적, 기대 효과, 추진 계획, 예산 등 실제 심사자가 중요하게 평가할 만한 내용을 기준으로 판단해야 합니다.

# 출력 형식
- 반드시 항목 번호를 붙여 정리하세요.
- 항목당 하나의 평가 기준을 요약된 문장으로 표현하세요.
- 평가는 일반적으로 심사위원이 체크리스트 형태로 사용할 수 있게 작성되어야 합니다.

# 제약 조건
- 사업 설명 자체, 지원 자격, 신청 절차 등은 평가 기준이 아니므로 제외하세요.
- 문서에 나타나지 않은 추론은 하지 마세요.

예시:
1. 사업 목적의 구체성과 명확성
2. 사업 수행 인력의 전문성
3. 추진 일정의 현실성
4. 예산 편성의 타당성과 적정성
5. 기대 효과의 실현 가능성

# 입력 문서
{document_text}

# 출력 (평가 기준 항목 목록):
"""

    def make_prompt_to_query_document(self, document_text, question):
        return f"""
당신은 사업 제안서 문서 내용을 기반으로 질문에 정확하고 정직하게 답변하는 지능형 비서입니다.

# 역할
- 사용자가 사업 제안서에 관해 묻는 질문에 대해, 오직 해당 문서 내에 존재하는 정보를 바탕으로 답변하세요.
- 문서에 근거가 없는 정보는 절대로 상상해서 대답하지 마세요.

# 답변 형식
- 명확하고 간결한 문장으로 답변하세요.
- 문서 내용이 불충분하거나 해당 정보가 없다면 반드시 다음과 같이 대답하세요:
  → "해당 정보는 문서에서 찾을 수 없습니다."

# 제약 조건
- 질문이 명확하지 않아도 문서에서 최대한 근거 있는 부분을 찾아 응답하세요.
- 문서에 있는 내용 외에는 어떠한 추측이나 배경 지식을 사용하지 마세요.
- 반드시 한국어로 응답하세요.

# 입력 문서
{document_text}

# 질문
{question}

# 답변
"""
    
    def make_light_cleaning_prompt(self, text: str) -> str:
        return f"""
반드시 한국어로 대답하세요.        
다음 텍스트는 회의 음성을 텍스트로 전사한 초안입니다. 이 텍스트에는 말의 흐름, 반복, 비문, 맞춤법 오류 등이 있을 수 있습니다.

당신의 임무는 **내용이나 어순을 바꾸지 말고**, 단지 **띄어쓰기, 맞춤법, 문장 부호 등 최소한의 정리**만 하여 **사실성을 유지한 원문 기록**을 제공하는 것입니다.

## 지침:
- 반드시 한국어로 대답하세요.
- 문장의 흐름과 구조는 변경하지 마십시오.
- 의미 왜곡이 발생할 수 있는 표현 수정은 하지 마십시오.
- 단지 띄어쓰기, 맞춤법, 오타, 문장 부호만 다듬으십시오.
- 고유명사, 인물명, 발언 순서 등은 그대로 두십시오.
- 텍스트는 반드시 순수한 한국어로 작성하십시오.

---
반드시 한국어로 대답하세요.
아래 전사된 텍스트를 가볍게 정리하십시오:

{text}
"""
    
    def make_prompt(self, transcribed_text):
        return f"""
반드시 한국어로 대답하세요.        
다음은 음성에서 텍스트로 변환된 원문입니다. 이 텍스트는 말의 흐름에 따라 작성되어 있으며, 반복, 군더더기, 비문 등이 포함되어 있을 수 있습니다.

당신의 임무는 이 텍스트를 이해하기 쉬운 요약문으로 정리하는 것입니다.

## 지침:
- 반드시 한국어로 대답하세요.
- 핵심 내용을 파악하고 요점을 간결하게 정리하십시오.
- 말투나 반복, 불필요한 감탄사 등은 제거하십시오.
- 정제된 서면 문장 형태로 작성하십시오.
- 원문의 흐름을 보존하되, 문맥이 자연스럽고 명확하도록 재구성하십시오.
- 문체는 뉴스 기사나 공식 보고서처럼 객관적이고 깔끔하게 유지하십시오.
- 요약문은 반드시 **순수한 한국어로만 작성**하십시오. 중국어, 영어, 한자는 절대로 포함하지 마십시오.
- 회의록 작성 목적이므로 다음의 항목에 따라 구조화하십시오:

[회의 개요]
- 일자:
- 주최자:
- 회의 주제:

[주요 논의 사항]
- 

[핵심 키워드]
- 

[주요 결정 사항]
- 

[액션 아이템]
- 

[향후 일정]
- 

[회의 내용 요약]
- 반드시 한국어로 대답하세요.
- 위 형식에 맞게 내용을 구성하되, 실제 내용이 없을 경우 항목을 비워두십시오.
- 문장은 짧고 명확하게 작성하십시오.

---

이제 아래 텍스트를 회의록 형태로 요약하십시오:

{transcribed_text}
"""

    def make_keyword_extraction_prompt(self, text: str) -> str:
        return f"""
    반드시 한국어로 대답하세요.
    다음은 어떤 사업 계획 문서의 내용입니다. 이 사업과 유사한 사업들을 찾고자 합니다.
    핵심 키워드, 산업 분야, 목적을 1~2줄로 요약해 주세요.

    문서 내용:
    {text}
    """

    def make_general_question_prompt(self, question: str) -> str:
        return f"""
    반드시 한국어로 대답하세요.       
    다음은 사용자의 질문입니다. 아래 질문에 대해 가능한 사실에 기반해 간결하고 정확한 답변을 제공해 주세요.

    질문: {question}
    """

    def make_audio_transcription_prompt(self, transcript: str) -> str:
        return f"""
반드시 한국어로 대답하세요.    
다음 텍스트는 민원 전화 상담 내용을 전사한 것입니다. 질문과 답변을 구분해 JSON 배열 형태로 만들어 주세요.
반드시 JSON 형식만 출력해 주세요.

형식:
[
  {{ "question": "질문 내용", "answer": "답변 내용" }},
  ...
]

텍스트:
\"\"\"{transcript}\"\"\"
"""
    
    def make_fallback_prompt(self, question: str) -> str:
        return f"""아래 질문에 대해 반드시 한국어로만 답변하세요. 
    중국어, 영어, 일본어 등 다른 언어는 절대 사용하지 마세요. 
    한국어 이외의 언어가 한 글자라도 포함되면 안 됩니다. 
    민원 대응하듯이 정확하고 간결하게 답해 주세요.
    데이터베이스에 유사한 내용을 찾아 설명하고, 관련 법령이 있다면 추가 정보로 제시하세요.

    질문:
    {question}

    (반드시 한국어로만 답변하세요. 중국어, 영어, 일본어 등은 절대 사용하지 마세요. 한국어 이외의 언어가 한 글자라도 포함되면 안 됩니다.)
    """

    def make_contextual_prompt(self, question: str, context: str) -> str:
        return f"""아래는 '{question}'라는 질문에 대해 참고할 수 있는 여러 정보입니다:

    {context}

    위 정보를 바탕으로 반드시 한국어로만 답변하세요. 
    중국어, 영어, 일본어 등 다른 언어는 절대 사용하지 마세요. 
    한국어 이외의 언어가 한 글자라도 포함되면 안 됩니다. 
    민원에 응답하듯 간결하고 이해하기 쉬운 답변을 작성하세요.

    (반드시 한국어로만 답변하세요. 중국어, 영어, 일본어 등은 절대 사용하지 마세요. 한국어 이외의 언어가 한 글자라도 포함되면 안 됩니다.)
    """

